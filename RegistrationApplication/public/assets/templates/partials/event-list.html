<div class="container">
    <h3>Events</h3>

    <div class="col-md-6">
        <a ng-click="events.all()">All</a> | <a ng-click="events.clearCache()">Clear cache</a>
        <hr>
        Search: <input ng-model="search.$" type="text">
        <table class="table">
            <thead>
            <tr>
                <th>Name</th>
                <th>Tags</th>
                <th>Latitude | Longitude</th>
                <th>Creator</th>
            </tr>
            </thead>
            <tbody>
                <tr ng-if="!events.eventsList"><td>There seems to be no events</td></tr>
                <tr ng-repeat="e in events.eventsList|filter:search">
                    {{e}}
                    <td><a ng-href="/events/{{e.id}}">{{e.name || "Missing name"}}</a></td>
                    <td>
                        <span ng-repeat="t in e.tags" class="tag">{{t.name}}
                        </span>
                    </td>
                    <td>{{e.latitude}}{{e.longitude}}</td>
                    <td><a ng-href="user/{{e.user.username}}">{{e.user.username}}</a></td>
                </tr>
            </tbody>
        </table>
        <div class="tags" ng-if="events.tags">
            <h4>Tags</h4>
            <div ng-repeat="tt in events.tags" class="tag">
                <span ng-click="events.filterEvents(tt)">{{tt}}</span>
            </div>
        </div>
        <div class="users" ng-if="events.users">
            <h4>Users</h4>
            <div ng-repeat="u in events.users" class="user">
                <div ng-click="events.filterEventsByUser(u)">{{u}}</div>
            </div>
        </div>
    </div>
    <div class="filters">
        <div class="tags" ng-if="events.filteredByTag.length > 0">
            <h4>Filtered by tags</h4>
            <div ng-repeat="f in events.filteredByTag" class="tag">
                <span>{{f}} <button class="close" ng-click="events.removeFilterByTag(f)">&times;</button></span>
            </div>
        </div>
        <div class="users" ng-if="events.filteredByUser != null">
            <h4>Filtered by user</h4>
            <div class="user">
                <span>{{events.filteredByUser}} <button class="close" ng-click="events.removeFilterByUser()">&times;</button></span>
            </div>
        </div>
    </div>
    <style>
        button.close {
            float:initial;
        }
        .angular-google-map-container {
            height: 400px;
            width: 100%;
        }
    </style>
    <ui-gmap-google-map center="map.center" zoom="map.zoom" options="options">
        <ui-gmap-marker ng-repeat="m in events.markers" coords="{latitude:m.latitude, longitude:m.longitude}" idKey="m.idKey" ng-if="m.latitude && m.longitude"></ui-gmap-marker>
    </ui-gmap-google-map>
</div>